# Smallfloat extension; based on Occamy
#
# format of a line in this file:
# <instruction name> <args> <opcode>
#
# <opcode> is given by specifying one or more range/value pairs:
# hi..lo=value or bit=value or arg=value (e.g. 6..2=0x45 10=1 rd=0)
#
# <args> is one of rd, rs1, rs2, rs3, aqrl, fm, pred, succ, rm,
# funct3, imm20, jimm20, imm12, imm12hi, bimm12hi, imm12lo,
# bimm12lo, zimm, shamt, shamtw, imm5, imm6, vd, vs3, vs1, vs2,
# vm, wd, amoop, nf, simm5, zimm11, prs3, L, uimms, Luimm5,
# vseglen, stagger_max, stagger_mask

# INFO: overlaps with opcodes-sflt_CUSTOM, opcodes-rv32d-zfh_DRAFT,
# opcodes-rv32q-zfh_DRAFT, opcodes-rv32zfh_DRAFT, opcodes-rv64zfh_DRAFT

# ASCII Art from here: https://fsymbols.com/generators/carty/

# ░██████╗░█████╗░░█████╗░██╗░░░░░░█████╗░██████╗░
# ██╔════╝██╔══██╗██╔══██╗██║░░░░░██╔══██╗██╔══██╗
# ╚█████╗░██║░░╚═╝███████║██║░░░░░███████║██████╔╝
# ░╚═══██╗██║░░██╗██╔══██║██║░░░░░██╔══██║██╔══██╗
# ██████╔╝╚█████╔╝██║░░██║███████╗██║░░██║██║░░██║
# ╚═════╝░░╚════╝░╚═╝░░╚═╝╚══════╝╚═╝░░╚═╝╚═╝░░╚═╝

#SMALLFLOAT SCALAR (fmt: 0=s, 1=d, 2=h (ha with rm=0b101) 3=b)
# same instrucion format as F extension
# collected under "Xsmallfloat" name - naming not final

# █░█ ▄▀█ █░░ █▀▀
# █▀█ █▀█ █▄▄ █▀░

# RV32Xfhalf - half-precision floats
# startgroup Xfhalf half-precision floats
flh       rd rs1 imm12 14..12=1 6..2=0x01 1..0=3
fsh       imm12hi rs1 rs2 imm12lo 14..12=1 6..2=0x09 1..0=3
fmadd.h   rd rs1 rs2 rs3 rm 26..25=2 6..2=0x10 1..0=3
fmsub.h   rd rs1 rs2 rs3 rm 26..25=2 6..2=0x11 1..0=3
fnmsub.h  rd rs1 rs2 rs3 rm 26..25=2 6..2=0x12 1..0=3
fnmadd.h  rd rs1 rs2 rs3 rm 26..25=2 6..2=0x13 1..0=3
fadd.h    rd rs1 rs2      31..27=0x00 rm       26..25=2 6..2=0x14 1..0=3
fsub.h    rd rs1 rs2      31..27=0x01 rm       26..25=2 6..2=0x14 1..0=3
fmul.h    rd rs1 rs2      31..27=0x02 rm       26..25=2 6..2=0x14 1..0=3
fdiv.h    rd rs1 rs2      31..27=0x03 rm       26..25=2 6..2=0x14 1..0=3
fsqrt.h   rd rs1 24..20=0 31..27=0x0B rm       26..25=2 6..2=0x14 1..0=3
fsgnj.h   rd rs1 rs2      31..27=0x04 14..12=0 26..25=2 6..2=0x14 1..0=3
fsgnjn.h  rd rs1 rs2      31..27=0x04 14..12=1 26..25=2 6..2=0x14 1..0=3
fsgnjx.h  rd rs1 rs2      31..27=0x04 14..12=2 26..25=2 6..2=0x14 1..0=3
fmin.h    rd rs1 rs2      31..27=0x05 14..12=0 26..25=2 6..2=0x14 1..0=3
fmax.h    rd rs1 rs2      31..27=0x05 14..12=1 26..25=2 6..2=0x14 1..0=3
feq.h     rd rs1 rs2      31..27=0x14 14..12=2 26..25=2 6..2=0x14 1..0=3
flt.h     rd rs1 rs2      31..27=0x14 14..12=1 26..25=2 6..2=0x14 1..0=3
fle.h     rd rs1 rs2      31..27=0x14 14..12=0 26..25=2 6..2=0x14 1..0=3
fcvt.w.h  rd rs1 24..20=0 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
fcvt.wu.h rd rs1 24..20=1 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
fcvt.h.w  rd rs1 24..20=0 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
fcvt.h.wu rd rs1 24..20=1 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
fmv.x.h   rd rs1 24..20=0 31..27=0x1C 14..12=0 26..25=2 6..2=0x14 1..0=3
fclass.h  rd rs1 24..20=0 31..27=0x1C 14..12=1 26..25=2 6..2=0x14 1..0=3
fmv.h.x   rd rs1 24..20=0 31..27=0x1E 14..12=0 26..25=2 6..2=0x14 1..0=3
# RV64Xfhalf: in addition to the above
fcvt.l.h  rd rs1 24..20=2 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
fcvt.lu.h rd rs1 24..20=3 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
fcvt.h.l  rd rs1 24..20=2 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
fcvt.h.lu rd rs1 24..20=3 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
# XfhalfwithF - half-precision conversions with F extension
fcvt.s.h  rd rs1 24..20=2 31..27=0x08 14..12=0 26..25=0 6..2=0x14 1..0=3
fcvt.h.s  rd rs1 24..20=0 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
# XfhalfwithD - half-precision conversions with D extension (in addition to XfhalfwithF)
fcvt.d.h  rd rs1 24..20=2 31..27=0x08 14..12=0 26..25=1 6..2=0x14 1..0=3
fcvt.h.d  rd rs1 24..20=1 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
# end_group

# ▄▀█ █░░ ▀█▀ █▀▀ █▀█ █▄░█ ▄▀█ ▀█▀ █▀▀   █░█ ▄▀█ █░░ █▀▀
# █▀█ █▄▄ ░█░ ██▄ █▀▄ █░▀█ █▀█ ░█░ ██▄   █▀█ █▀█ █▄▄ █▀░

# RV32Xfalthalf - alternate half-precision floats
# startgroup Xfalthalf alternate half-precision floats
@flah      rd rs1 imm12 14..12=1 6..2=0x01 1..0=3
@fsah      imm12hi rs1 rs2 imm12lo 14..12=1 6..2=0x09 1..0=3
@fmadd.ah   rd rs1 rs2 rs3 rm 26..25=2 6..2=0x10 1..0=3
@fmsub.ah   rd rs1 rs2 rs3 rm 26..25=2 6..2=0x11 1..0=3
@fnmsub.ah  rd rs1 rs2 rs3 rm 26..25=2 6..2=0x12 1..0=3
@fnmadd.ah  rd rs1 rs2 rs3 rm 26..25=2 6..2=0x13 1..0=3
@fadd.ah    rd rs1 rs2      31..27=0x00 rm       26..25=2 6..2=0x14 1..0=3
@fsub.ah    rd rs1 rs2      31..27=0x01 rm       26..25=2 6..2=0x14 1..0=3
@fmul.ah    rd rs1 rs2      31..27=0x02 rm       26..25=2 6..2=0x14 1..0=3
@fdiv.ah    rd rs1 rs2      31..27=0x03 rm       26..25=2 6..2=0x14 1..0=3
@fsqrt.ah   rd rs1 24..20=0 31..27=0x0B rm       26..25=2 6..2=0x14 1..0=3
@fsgnj.ah   rd rs1 rs2      31..27=0x04 14..12=0 26..25=2 6..2=0x14 1..0=3
@fsgnjn.ah  rd rs1 rs2      31..27=0x04 14..12=1 26..25=2 6..2=0x14 1..0=3
@fsgnjx.ah  rd rs1 rs2      31..27=0x04 14..12=2 26..25=2 6..2=0x14 1..0=3
@fmin.ah    rd rs1 rs2      31..27=0x05 14..12=0 26..25=2 6..2=0x14 1..0=3
@fmax.ah    rd rs1 rs2      31..27=0x05 14..12=1 26..25=2 6..2=0x14 1..0=3
@feq.ah     rd rs1 rs2      31..27=0x14 14..12=2 26..25=2 6..2=0x14 1..0=3
@flt.ah     rd rs1 rs2      31..27=0x14 14..12=1 26..25=2 6..2=0x14 1..0=3
@fle.ah     rd rs1 rs2      31..27=0x14 14..12=0 26..25=2 6..2=0x14 1..0=3
@fcvt.w.ah  rd rs1 24..20=0 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.wu.ah rd rs1 24..20=1 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.w  rd rs1 24..20=0 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.wu rd rs1 24..20=1 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
@fmv.x.ah   rd rs1 24..20=0 31..27=0x1C 14..12=0 26..25=2 6..2=0x14 1..0=3
@fclass.ah  rd rs1 24..20=0 31..27=0x1C 14..12=1 26..25=2 6..2=0x14 1..0=3
@fmv.ah.x   rd rs1 24..20=0 31..27=0x1E 14..12=0 26..25=2 6..2=0x14 1..0=3
# RV64Xfhalf: in addition to the above
@fcvt.l.ah  rd rs1 24..20=2 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.lu.ah rd rs1 24..20=3 31..27=0x18 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.l  rd rs1 24..20=2 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.lu rd rs1 24..20=3 31..27=0x1A rm       26..25=2 6..2=0x14 1..0=3
# XfhalfwithF - half-precision conversions with F extension
@fcvt.s.ah  rd rs1 24..20=2 31..27=0x08 14..12=0 26..25=0 6..2=0x14 1..0=3
@fcvt.ah.s  rd rs1 24..20=0 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
# XfhalfwithD - half-precision conversions with D extension (in addition to XfhalfwithF)
@fcvt.d.ah  rd rs1 24..20=2 31..27=0x08 14..12=0 26..25=1 6..2=0x14 1..0=3
@fcvt.ah.d  rd rs1 24..20=1 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
# Xfalthalfwithhalf - alternate half-precision conversions with Xfhalf extension
fcvt.h.h    rd rs1 24..20=2 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.h  rd rs1 24..20=2 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.h.ah  rd rs1 24..20=2 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
@fcvt.ah.ah rd rs1 24..20=2 31..27=0x08 rm       26..25=2 6..2=0x14 1..0=3
# end_group

# █▀█ █░█ ▄▀█ █▀█ ▀█▀ █▀▀ █▀█
# ▀▀█ █▄█ █▀█ █▀▄ ░█░ ██▄ █▀▄

# RV32Xfquarter - quarter-precision floats
# startgroup Xfquarter quarter-precision floats
# b collides with quad precision (q) so they are pseudo here (not pseudo for LLVM).
@flb       rd rs1 imm12 14..12=4 6..2=0x01 1..0=3
@fsb       imm12hi rs1 rs2 imm12lo 14..12=4 6..2=0x09 1..0=3
@fmadd.b   rd rs1 rs2 rs3 rm 26..25=3 6..2=0x10 1..0=3
@fmsub.b   rd rs1 rs2 rs3 rm 26..25=3 6..2=0x11 1..0=3
@fnmsub.b  rd rs1 rs2 rs3 rm 26..25=3 6..2=0x12 1..0=3
@fnmadd.b  rd rs1 rs2 rs3 rm 26..25=3 6..2=0x13 1..0=3
@fadd.b    rd rs1 rs2      31..27=0x00 rm       26..25=3 6..2=0x14 1..0=3
@fsub.b    rd rs1 rs2      31..27=0x01 rm       26..25=3 6..2=0x14 1..0=3
@fmul.b    rd rs1 rs2      31..27=0x02 rm       26..25=3 6..2=0x14 1..0=3
@fdiv.b    rd rs1 rs2      31..27=0x03 rm       26..25=3 6..2=0x14 1..0=3
@fsqrt.b   rd rs1 24..20=0 31..27=0x0B rm       26..25=3 6..2=0x14 1..0=3
@fsgnj.b   rd rs1 rs2      31..27=0x04 14..12=0 26..25=3 6..2=0x14 1..0=3
@fsgnjn.b  rd rs1 rs2      31..27=0x04 14..12=1 26..25=3 6..2=0x14 1..0=3
@fsgnjx.b  rd rs1 rs2      31..27=0x04 14..12=2 26..25=3 6..2=0x14 1..0=3
@fmin.b    rd rs1 rs2      31..27=0x05 14..12=0 26..25=3 6..2=0x14 1..0=3
@fmax.b    rd rs1 rs2      31..27=0x05 14..12=1 26..25=3 6..2=0x14 1..0=3
@feq.b     rd rs1 rs2      31..27=0x14 14..12=2 26..25=3 6..2=0x14 1..0=3
@flt.b     rd rs1 rs2      31..27=0x14 14..12=1 26..25=3 6..2=0x14 1..0=3
@fle.b     rd rs1 rs2      31..27=0x14 14..12=0 26..25=3 6..2=0x14 1..0=3
@fcvt.w.b  rd rs1 24..20=0 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.wu.b rd rs1 24..20=1 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.b.w  rd rs1 24..20=0 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
@fcvt.b.wu rd rs1 24..20=1 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
@fmv.x.b   rd rs1 24..20=0 31..27=0x1C 14..12=0 26..25=3 6..2=0x14 1..0=3
@fclass.b  rd rs1 24..20=0 31..27=0x1C 14..12=1 26..25=3 6..2=0x14 1..0=3
@fmv.b.x   rd rs1 24..20=0 31..27=0x1E 14..12=0 26..25=3 6..2=0x14 1..0=3
# RV64Xfquarter: in addition to the above
@fcvt.l.b  rd rs1 24..20=2 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.lu.b rd rs1 24..20=3 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.b.l  rd rs1 24..20=2 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
@fcvt.b.lu rd rs1 24..20=3 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
# XfquarterwithF - quarter-precision conversions with F extension
@fcvt.s.b  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=0 6..2=0x14 1..0=3
@fcvt.b.s  rd rs1 24..20=0 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3
# XfquarterwithD - quarter-precision conversions with D extension (in addition to XfquarterwithF)
@fcvt.d.b  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=1 6..2=0x14 1..0=3
@fcvt.b.d  rd rs1 24..20=1 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3
# Xfquarterwithhalf - quarter-precision conversions with Xfhalf extension
fcvt.h.b    rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=2 6..2=0x14 1..0=3
fcvt.b.h    rd rs1 24..20=2 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3
# Xfquarterwithalthalf - quarter-precision conversions with Xfalthalf extension
@fcvt.ah.b  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=2 6..2=0x14 1..0=3
@fcvt.b.ah  rd rs1 24..20=2 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3
# end_group


# ▄▀█ █░░ ▀█▀ █▀▀ █▀█ █▄░█ ▄▀█ ▀█▀ █▀▀   █▀█ █░█ ▄▀█ █▀█ ▀█▀ █▀▀ █▀█
# █▀█ █▄▄ ░█░ ██▄ █▀▄ █░▀█ █▀█ ░█░ ██▄   ▀▀█ █▄█ █▀█ █▀▄ ░█░ ██▄ █▀▄

# RV32Xfaltquarter - alternate quarter-precision floats
# startgroup Xfaltquarter alternate quarter-precision floats
# ab collides with quad precision (q) so they are pseudo here.
@flab       rd rs1 imm12 14..12=0 6..2=0x01 1..0=3
@fsab       imm12hi rs1 rs2 imm12lo 14..12=0 6..2=0x09 1..0=3
@fmadd.ab   rd rs1 rs2 rs3 rm 26..25=3 6..2=0x10 1..0=3
@fmsub.ab   rd rs1 rs2 rs3 rm 26..25=3 6..2=0x11 1..0=3
@fnmsub.ab  rd rs1 rs2 rs3 rm 26..25=3 6..2=0x12 1..0=3
@fnmadd.ab  rd rs1 rs2 rs3 rm 26..25=3 6..2=0x13 1..0=3
@fadd.ab    rd rs1 rs2      31..27=0x00 rm       26..25=3 6..2=0x14 1..0=3
@fsub.ab    rd rs1 rs2      31..27=0x01 rm       26..25=3 6..2=0x14 1..0=3
@fmul.ab    rd rs1 rs2      31..27=0x02 rm       26..25=3 6..2=0x14 1..0=3
@fdiv.ab    rd rs1 rs2      31..27=0x03 rm       26..25=3 6..2=0x14 1..0=3
@fsqrt.ab   rd rs1 24..20=0 31..27=0x0B rm       26..25=3 6..2=0x14 1..0=3
@fsgnj.ab   rd rs1 rs2      31..27=0x04 14..12=0 26..25=3 6..2=0x14 1..0=3
@fsgnjn.ab  rd rs1 rs2      31..27=0x04 14..12=1 26..25=3 6..2=0x14 1..0=3
@fsgnjx.ab  rd rs1 rs2      31..27=0x04 14..12=2 26..25=3 6..2=0x14 1..0=3
@fmin.ab    rd rs1 rs2      31..27=0x05 14..12=0 26..25=3 6..2=0x14 1..0=3
@fmax.ab    rd rs1 rs2      31..27=0x05 14..12=1 26..25=3 6..2=0x14 1..0=3
@feq.ab     rd rs1 rs2      31..27=0x14 14..12=2 26..25=3 6..2=0x14 1..0=3
@flt.ab     rd rs1 rs2      31..27=0x14 14..12=1 26..25=3 6..2=0x14 1..0=3
@fle.ab     rd rs1 rs2      31..27=0x14 14..12=0 26..25=3 6..2=0x14 1..0=3
@fcvt.w.ab  rd rs1 24..20=0 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.wu.ab rd rs1 24..20=1 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3
@fcvt.ab.w  rd rs1 24..20=0 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
@fcvt.ab.wu rd rs1 24..20=1 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3
@fmv.x.ab   rd rs1 24..20=0 31..27=0x1C 14..12=0 26..25=3 6..2=0x14 1..0=3
@fclass.ab  rd rs1 24..20=0 31..27=0x1C 14..12=1 26..25=3 6..2=0x14 1..0=3
@fmv.ab.x   rd rs1 24..20=0 31..27=0x1E 14..12=0 26..25=3 6..2=0x14 1..0=3
# RV64Xfaltquarter: in addition to the above
@fcvt.l.ab  rd rs1 24..20=2 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
@fcvt.lu.ab rd rs1 24..20=3 31..27=0x18 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.l  rd rs1 24..20=2 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.lu rd rs1 24..20=3 31..27=0x1A rm       26..25=3 6..2=0x14 1..0=3 # same as .b
# XfaltquarterwithF - quarter-precision conversions with F extension
@fcvt.s.ab  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=0 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.s  rd rs1 24..20=0 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
# XfaltquarterwithD - quarter-precision conversions with D extension (in addition to XfquarterwithF)
@fcvt.d.ab  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=1 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.d  rd rs1 24..20=1 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
# Xfaltquarterwithhalf - quarter-precision conversions with Xfhalf extension
@fcvt.h.ab  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=2 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.h  rd rs1 24..20=2 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
# Xfaltquarterwithalthalf - quarter-precision conversions with Xfalthalf extension
@fcvt.ah.ab rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=2 6..2=0x14 1..0=3 # same as .b
@fcvt.ab.ah rd rs1 24..20=2 31..27=0x08 rm       26..25=3 6..2=0x14 1..0=3 # same as .b
# Xfaltquarterwithquarter - quarter-precision conversions with Xfalthalf extension
fcvt.b.b    rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=3 6..2=0x14 1..0=3
@fcvt.ab.b  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=3 6..2=0x14 1..0=3
@fcvt.b.ab  rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=3 6..2=0x14 1..0=3
@fcvt.ab.ab rd rs1 24..20=3 31..27=0x08 14..12=0 26..25=3 6..2=0x14 1..0=3
